# 体系架构相关配置<a name="ZH-CN_TOPIC_0184192753"></a>

## 概述<a name="section891512161392"></a>

XML中还有一部分体系架构相关的配置，这部分配置包括主板，CPU，一些与体系架构相关的feature，本章节主要介绍它们的配置和含义。

## 元素介绍<a name="section5884430104314"></a>

-   os：定义虚拟机启动参数。

    子元素type：指定虚拟机类型，属性arch表示架构类型，如aarch64，属性machine表示虚拟机的芯片组类型，虚拟机支持的芯片组可以通过 **qemu-kvm -machine ?**命令查询，如AArch64结构使用“virt”类型。

    子元素loader：指定加载固件 ，如配置EDK提供的UEFI文件，属性readonly表示是否是只读文件，值为“yes”或“no”，属性type表示loader的类型，常用的值有“rom”、“pflash”。

    子元素nvram：指定nvram文件路径，用于存储UEFI启动配置。


-   features：hypervisor支持控制一些虚拟机CPU/machine的特性，如高级电源管理接口“acpi”，ARM处理器指定GICv3中断控制器等。

## AArch64架构配置示例<a name="section647718146174"></a>

虚拟机的类型为AArch64结构，使用virt芯片组，利用UEFI启动的虚拟机配置如下：

```
<domain type='kvm'>
    ...
    <os>
        <type arch='aarch64' machine='virt'>hvm</type>
        <loader readonly='yes' type='pflash'>/usr/share/edk2/aarch64/QEMU_EFI-pflash.raw</loader>
        <nvram>/var/lib/libvirt/qemu/nvram/openEulerVM.fd</nvram>
    </os>
    ...
</domain>
```

为虚拟机配置ACPI和GIC V3中断控制器特性。

```
<features>
    <acpi/>
    <gic version='3'/>
</features>
```

## x86\_64架构配置示例<a name="section416341234917"></a>

x86\_64架构支持BIOS和UEFI两种启动方式，如果不配置loader，则使用默认启动方式BIOS。这里给出启动方式为UEFI、芯片组为q35的配置参考。

```
<domain type='kvm'>
    ...
    <os>
        <type arch='x86_64' machine='q35'>hvm</type>
        <loader type='rom'>/usr/share/edk2/ovmf/OVMF.fd</loader>
    </os>
    ...
</domain>
```

