# 存储快照<a name="ZH-CN_TOPIC_0225484570"></a>

## 概述<a name="section1459575321614"></a>

虚拟机在使用过程中可能由于病毒对系统的破坏、系统文件被误删除或误格式化等原因造成虚拟机系统损坏导致系统无法启动。为了使损坏的系统快速恢复，openEuler提供了存储快照功能。openEuler可以在用户不感知的情况下制作虚拟机在某一时刻的快照（制作通常指需要几秒钟），该快照能帮助用户将磁盘快速恢复到某一时刻的状态，例如系统损坏后能快速恢复系统，从而提升系统可靠性。

>![](public_sys-resources/icon-note.gif) **说明：**   
>当前存储快照只支持raw、qcow2格式镜像，不支持block块设备。  

## 操作步骤<a name="section1234014366477"></a>

制作虚拟机存储快照的操作步骤如下：

1.  登录主机，通过virsh domblklist命令查询虚拟机使用的磁盘。

    ```
    # virsh domblklist openEulerVM
      Target   Source
     ---------------------------------------------
      vda      /mnt/openEuler-image.qcow2
    ```


1.  创建虚拟机磁盘快照_openEuler-snapshot1.qcow2_，命令及回显如下：

    ```
    # virsh snapshot-create-as --domain openEulerVM --disk-only --diskspec vda,snapshot=external,file=/mnt/openEuler-snapshot1.qcow2 --atomic
    Domain snapshot 1582605802 created
    ```


1.  磁盘快照查询操作。

    ```
    # virsh snapshot-list openEulerVM
     Name         Creation Time               State
    ---------------------------------------------------------
     1582605802   2020-02-25 12:43:22 +0800   disk-snapshot
    ```


