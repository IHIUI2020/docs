# 编写安装后脚本<a name="ZH-CN_TOPIC_0187280636"></a>

您可以在安装完成后、第一次重启前添加要在该系统中运行的命令。这部分内容必须在 kickstart 的最后，同时必须用 %post 命令开头，以 %end 结尾。

>![](public_sys-resources/icon-note.gif) **说明：**   
>如果您的 kickstart 文件还包括一个 %pre 部分，那 %pre 和 %post 的顺序是没有关系的。  

## 脚本说明<a name="zh-cn_topic_0151920770_s4d3bc4f1db8247f2862310e0e58392ec"></a>

这部分在安装附加软件或者配置附加名称服务器时有用。可在后安装脚本中使用以下选项来改变安装行为。要使用这些选项，请将其添加到该脚本开始的 %post 行。例如：

```
%post --interpreter=/usr/bin/python
--- Python script omitted --
%end
```

-   --interpreter=

    允许指定不同的脚本语言，如 Python。例如：

    ```
    %post --interpreter=/usr/bin/python
    ```

    可使用该系统中可用的任意脚本语言。在大多数情况下是 /usr/bin/sh、/usr/bin/bash 和 /usr/bin/python。

-   --nochroot

    允许指定要在 chroot 环境之外执行的命令。下例将 /etc/resolv.conf 文件复制到刚安装的文件系统里。

    ```
    %post --nochroot
    cp /etc/resolv.conf /mnt/sysimage/etc/resolv.conf
    %end
    ```

-   --erroronfail

    如果脚本失败则显示出错信息并暂停安装。该出错信息可让您进入记录失败原因的位置。例如：

    ```
    %post --log=/mnt/sysimage/root/anaconda-post.log --erroronfail
    ```

-   --log=

    在指定的日志文件中记录该脚本的输出结果。

    ```
    %post --log=/root/ks-post.log
    ```


## 应用示例<a name="zh-cn_topic_0151920770_s2a765a1c0a7d4016a411d169478f968a"></a>

以下是 %post 部分的示例：

```
# Start of the %post section with logging into /root/ks-post.log
%post --log=/root/ks-post.log

# Mount an NFS share
mkdir /mnt/temp
mount -o nolock 10.10.0.2:/usr/new-machines /mnt/temp
openvt -s -w -- /mnt/temp/runme
umount /mnt/temp

# End of the %post section
%end
```

上面的示例是挂载一个 NFS 共享，并执行该共享中位于 /usr/new-machines/ 的名为 runme 的脚本。

